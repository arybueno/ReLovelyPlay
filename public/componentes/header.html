<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Seu Site</title>

    <link rel="stylesheet" href="/componentes/header.css">
</head>

<body>

<audio id="musicaFundo" src="/musica.mp3" loop></audio>

<header>
  <div id="teste">
    
    <button class="voltar" onclick="window.location.href='/'">
      <img id="logo" src="/img/gameboy.png" alt="">
    </button>

    <div id="botaoPerfil" class="perfil-btn">
      <img id="fotoPerfil" class="foto" src="" alt="">
      <span id="nomePerfil"></span>
    </div>

  </div>

  <div id="pontosUsuario" class="pontos"></div>

  <button id="ranking-btn" onclick="window.location.href='/ranking'">
    <img src="/img/rankingbutton.png" alt="">
  </button>

  <!-- BOTÃO PLAY/PAUSE -->
  <button id="btnSom">
    <img id="imgSom" src="/img/som_off.png" alt="">
  </button>
</header>

<script>
  const audio = document.getElementById("musicaFundo");
  const btnSom = document.getElementById("btnSom");
  const imgSom = document.getElementById("imgSom");

  // Se estava tocando na página anterior
  if (localStorage.getItem("musicaAtiva") === "true") {
    audio.currentTime = Number(localStorage.getItem("musicaTempo")) || 0;
    audio.play().catch(() => {});
    imgSom.src = "/img/som_on.png";
  }

  // Guardar tempo da música
  setInterval(() => {
    localStorage.setItem("musicaTempo", audio.currentTime);
  }, 500);

  // Primeira interação
  window.addEventListener("click", () => {
    if (audio.paused && localStorage.getItem("musicaAtiva") === "true") {
      audio.play().catch(()=>{});
    }
  }, { once: true });

  // Botão play/pause
  btnSom.addEventListener("click", () => {
    if (audio.paused) {
      audio.play();
      localStorage.setItem("musicaAtiva", "true");
      imgSom.src = "/img/som_on.png";
    } else {
      audio.pause();
      localStorage.setItem("musicaAtiva", "false");
      imgSom.src = "/img/som_off.png";
    }
  });
</script>

<script type="module" src="/firebase-init.js"></script>
<script type="module" src="/componentes/headerdata.js"></script>

</body>
</html>

